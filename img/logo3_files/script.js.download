(function($){'use strict';var $gutter=0,pingraphy={initReady:function(){this.menuAnimate();this.searchAnimate();this.homepage();this.mobileMenu();this.scrollTop();this.postFavor();this.cookieFavor();this.socialSharer();this.fbLikeBox();if(typeof loadStyle!='undefined'){if(loadStyle==='infinite'){this.infiniteScroll();}else{this.infiniteLoading();}}},fbLikeBox:function(){(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9&appId=1615727725316685";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));},socialSharer:function(){if($('.tc-social-sharing').length){$('.tc-social-sharing a').jqSocialSharer();$('.btn-hide').on('click',function(e){e.preventDefault();var open=$(this).hasClass('active');if(!open){$(this).addClass('active');$('.sticky-left').addClass('hide-social');}else{$(this).removeClass('active');$('.sticky-left').removeClass('hide-social');}});}},menuAnimate:function(){var self=this;$('.section-one .toggle-mobile-menu').on('click',function(e){if($('.section-two .toggle-mobile-menu').hasClass('active')){$('.section-two .toggle-mobile-menu').removeClass('active');$('.section-two .toggle-mobile-menu').next('.second-navigation').removeClass('main-nav-open');}
e.preventDefault();e.stopPropagation();if($(this).hasClass('active')){$(this).removeClass('active');$(this).next('.main-navigation').removeClass('main-nav-open');}else{$(this).addClass('active');$(this).next('.main-navigation').addClass('main-nav-open');}});$('.section-two .toggle-mobile-menu').on('click',function(e){if($('.section-one .toggle-mobile-menu').hasClass('active')){$('.section-one .toggle-mobile-menu').removeClass('active');$('.section-one .toggle-mobile-menu').next('.main-navigation').removeClass('main-nav-open');}
if($(this).hasClass('active')){$(this).removeClass('active');$(this).next().removeClass('main-nav-open');}else{$(this).addClass('active');$(this).next().addClass('main-nav-open');}});$(document).click(function(e){if($('.main-navigation').hasClass('main-nav-open')){e.stopPropagation();$('.main-navigation').removeClass('main-nav-open');}});var catcher=$('#catcher'),sticky=$('#sticky'),bodyTop=$('body').offset().top;if(sticky.length){$(window).scroll(function(){pingraphy.stickThatMenu(sticky,catcher,bodyTop);});$(window).resize(function(){pingraphy.stickThatMenu(sticky,catcher,bodyTop);});}},isScrolledTo:function(elem,top){var docViewTop=$(window).scrollTop();var docViewBottom=docViewTop+$(window).height();var elemTop=$(elem).offset().top-top;var elemBottom=elemTop+$(elem).height();return((elemTop<=docViewTop));},stickThatMenu:function(sticky,catcher,top){var self=this;if(self.isScrolledTo(sticky,top)){sticky.addClass('sticky-nav');catcher.height(sticky.height());}
var stopHeight=catcher.offset().top;if(stopHeight>sticky.offset().top){sticky.removeClass('sticky-nav');catcher.height(0);}},searchAnimate:function(){var header=$('.site-header');var trigger=$('#trigger-overlay');var overlay=header.find('.search-overlay');var input=header.find('.hideinput, .header-search .fa-search');trigger.click(function(e){$(this).hide();overlay.addClass('open').find('input').focus();});$('.overlay-close').click(function(e){$('.site-header .search-overlay').addClass('closed').removeClass('open');setTimeout(function(){$('.site-header .search-overlay').removeClass('closed');},400);$('#trigger-overlay').show();});$(document).on('click',function(e){var target=$(e.target);if(target.is('.search-overlay')||target.closest('.search-overlay').length)return true;$('.site-header .search-overlay').addClass('closed').removeClass('open');setTimeout(function(){$('.site-header .search-overlay').removeClass('closed');},400);$('#trigger-overlay').show();});$('#trigger-overlay').click(function(e){e.preventDefault();e.stopPropagation();});},homepage:function(){var $container=$('#masonry-container');if($('.home-fullwidth').length>0){$gutter=30;}else{$gutter=10;}
$container.imagesLoaded().progress(function(){if($('.masonry .so-panel').length){$('.so-panel').masonry({columnWidth:'.item',gutter:$gutter,isFitWidth:true,animationOptions:{duration:700,queue:true}});}else{$('.masonry').masonry({columnWidth:'.item',gutter:$gutter,isFitWidth:true,animationOptions:{duration:700,queue:true}});}});},mobileMenu:function(){$('#masthead .menu-item-has-children > a').append('<i class="fa arrow-sub-menu fa-chevron-right"></i>');$('.arrow-sub-menu').on('click',function(e){e.preventDefault();e.stopPropagation();var active=$(this).hasClass('fa-chevron-down');if(!active){$(this).parent().next().css({'display':'block'});$(this).removeClass('fa-chevron-right').addClass('fa-chevron-down');}else{$(this).parent().next().css({'display':'none'});$(this).removeClass('fa-chevron-down').addClass('fa-chevron-right');}});},infiniteLoading:function(){var pageNumber=2;if($('.home-fullwidth').length>0){$gutter=30;}else{$gutter=10;}
$('#load-more-post').on('click',function(e){if(pageNumber<=totalPages){var data={action:'infinite_scroll',nonce:pingraphyLoadMore.nonce,page:pageNumber,query:pingraphyLoadMore.query,page_no:pageNumber};var that=this;e.preventDefault();$.ajax({url:pingraphyLoadMore.url,type:'POST',data:data,beforeSend:function(){$(that).html($(that).data('loading'));}}).done(function(html){$('#masonry-container > .masonry').append(html).each(function(){$('#masonry-container > .masonry').masonry('reloadItems');});setTimeout(function(){$('#masonry-container > .masonry').masonry({gutter:$gutter,isFitWidth:true,animate:true,animationOptions:{duration:700,queue:true}});pingraphy.postFavor();pingraphy.cookieFavor();},1000);$(that).html($(that).data('more'));});pageNumber++;if(pageNumber>totalPages){$(this).parent().hide();}}
e.preventDefault();});},infiniteScroll:function(){var pageNumber=2;var isLoading=false;if($('.home-fullwidth').length>0){$gutter=30;}else{$gutter=10;}
$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>$('.masonry').height()){if(pageNumber<=totalPages&&isLoading===false){var data={action:'infinite_scroll',nonce:pingraphyLoadMore.nonce,page:pageNumber,query:pingraphyLoadMore.query,};$.ajax({url:pingraphyLoadMore.url,type:'POST',data:data,beforeSend:function(){isLoading=true;$('.infinite-scroll').fadeIn();},success:function(data){$('#masonry-container > .masonry').append(data).each(function(){$('#masonry-container > .masonry').masonry('reloadItems');});setTimeout(function(){$('#masonry-container > .masonry').masonry({columnWidth:'.item',gutter:$gutter,isFitWidth:true,animate:true,animationOptions:{duration:700,queue:true}});pingraphy.postFavor();pingraphy.cookieFavor();},1000);isLoading=false;pageNumber++;$('.infinite-scroll').fadeOut();}});}}});},scrollTop:function(){var scrollDes='html,body';if(navigator.userAgent.match(/opera/i)){scrollDes='html';}
$(window).scroll(function(){if($(this).scrollTop()>130){$('.back-to-top').addClass('filling').removeClass('hiding');}else{$('.back-to-top').removeClass('filling').addClass('hiding');}});$('.back-to-top').click(function(){$(scrollDes).animate({scrollTop:0},{duration:500});});},postFavor:function(){$('.favor').on('click',function(e){if(!$(this).hasClass('favored')){var that=this;$.ajax({url:AdminAjaxURL.ajaxurl,type:'POST',data:'action=pingraphy_post_favor&post_id='+$(this).data('post-id'),success:function(data){$(that).children('span').html(data.count);Cookies.set('koocie-'+$(that).data('post-id'),$(that).data('post-id'));$(that).addClass('favored');}});}
e.preventDefault();});},cookieFavor:function(){$('a.favor').each(function(index,ele){var postId=$(ele).data('post-id');var cookie=Cookies.get('koocie-'+postId);if(typeof cookie!='undefined'){$(ele).addClass('favored');}});}};$(document).ready(function(){pingraphy.initReady();});})(jQuery);